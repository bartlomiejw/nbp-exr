import{d as U,r as k,a as K,c as M,t as N,E,n as q,b as B,e as I,f as P,g as W,h as R,i as T,j as F,k as J,o as n,l as d,m as l,p as g,w as m,F as b,q as v,s as z,u as D,v as C,x as V,y as G,z as H,A as Z,B as Q,C as X}from"./elementPlus.min.js";import{_ as L,c as Y,a as ee,i as te}from"./index.min.js";const se=e=>{const t=window.location.href,a=t.indexOf("admin.html")>0,o=document.querySelector(a?".wp-menu-open":`#toplevel_page_${e}`),c=t.substr(t.indexOf(a?"#/":"admin.php"));if(o){o.addEventListener("click",function(p){const f=p.target,S=this.querySelectorAll("li");for(let h=0;h<S.length;h++){let y=S[h];y!==p.target.parentElement?y.classList.remove("current"):f.parentElement.classList.add("current")}});const r=o.querySelectorAll(".current");for(let p=0;p<r.length;p++)r[p].classList.remove("current");let u=o.querySelector(`.wp-submenu a[href="${c}"`);!a&&c.endsWith("#/")&&(u=o.querySelector(".wp-submenu a.wp-first-item")),u&&(console.log(u),u.parentElement.classList.add("current"))}};const oe=U({name:"Settings",setup(){const e={},t=k({...e}),a=k({actionKey:0,loaded:!1}),o=k({sections:{},options:{}}),c=K(!1),r=M(()=>{const u=JSON.stringify(t),p=JSON.stringify(e);return a.actionKey=a.actionKey+1,u===p});return{settings:t,oldSettings:e,hasChanged:r,endpoints:{settings:""},ui:a,structure:o,hasLoaded:c}},methods:{async doSave(){try{let e=N(this.settings);const t=await this.axios.post(this.endpoints.settings,e);if(t.status===200){E({message:"Twoje ustawienia zosta\u0142y zapisane.",type:"success"});const o=this.$win.vue_wp_plugin_config_admin.settings||{},c={...this.settings};Object.keys(c).forEach(r=>{this.oldSettings[r]=c[r],o[r]=c[r]}),this.ui.actionKey=this.ui.actionKey+1}else E.error("Odpowied\u017A wordpress z b\u0142\u0119dem. "+JSON.stringify(t,null,2))}catch(e){E.error("Odpowied\u017A serwera z b\u0142\u0119dem. "+e.message)}},getOptions(e){const t={...this.structure.options},a=[];return Object.keys(t).forEach(o=>{const c=t[o];c.section===e&&(c.id=o,a.push(c))}),a},doCancel(){const e=this.oldSettings;Object.keys(e).forEach(t=>{this.oldSettings[t]=e[t],this.settings[t]=e[t]})},async doLoad(){await q();const e=this.$win.vue_wp_plugin_config_admin;this.$win.$appConfig.nonce||(this.$win.$appConfig.nonce=e.rest.nonce);const t=e.settingStructure;this.structure.sections=t.sections,this.structure.options=t.options;const a=e.settings||{};this.endpoints=e.rest.endpoints,Object.keys(a).forEach(o=>{this.oldSettings[o]=a[o],this.settings[o]=a[o]}),this.hasLoaded=!0,this.$forceUpdate()}},beforeMount(){const e=this;if(e.$win&&e.$win.vue_wp_plugin_config_admin){e.doLoad();return}document.onreadystatechange=async()=>{document.readyState==="complete"&&this.doLoad()}}});const ne=e=>(G("data-v-dbb5159c"),e=e(),H(),e),ae={key:0,class:"app-settings w-full flex flex-wrap mx-auto"},ie={class:"w-full md:w-1/5 pt-4"},le={class:"w-full sticky inset-0 lg:h-auto overflow-x-hidden overflow-y-auto lg:overflow-y-hidden lg:block mt-0 my-2 lg:my-0 border border-gray-400 lg:border-transparent bg-white shadow lg:shadow-none lg:bg-transparent z-20"},de=["href"],ce={class:"font-bold"},re={class:"space-x-3 flex justify-end pt-2"},ue=ne(()=>l("div",{class:"pt-2"},[l("p",null,[l("strong",null,"Widget - strona")]),l("code",{class:"m-auto block w-100"},"[nbpexr-vue-app view='ExchangeRates']")],-1)),pe={class:"w-full md:w-4/5 min-h-screen"},ge={class:"ml-3"},he=["id"],_e={class:"p-8 mt-6 lg:mt-0 rounded shadow bg-white"},me={class:"font-sans font-bold break-normal text-gray-700 pb-4 text-xl w-full"},fe={class:"md:flex mb-6"},ye={class:"md:w-3/5"},we={class:"block text-gray-600 font-bold md:text-left mb-3 md:mb-0 pr-4",for:"my-checkbox"},be={class:"py-2 text-sm text-gray-600"},ve={class:"md:w-2/5"},Se={key:0},Ve={key:1},$e={key:2},ke={key:3},Ee={key:4},Ce={key:5};function Oe(e,t,a,o,c,r){const u=B,p=I,f=P,S=W,h=R,y=T,x=F,A=J;return e.hasLoaded?(n(),d("div",ae,[l("aside",ie,[l("div",le,[g(p,{"default-active":"1",class:"rounded shadow bg-white"},{default:m(()=>[(n(!0),d(b,null,v(e.structure.sections,(w,_)=>(n(),C(u,{key:`el-menu-item-${_}`,index:_},{default:m(()=>[l("a",{href:`/settings${_}`},[l("span",ce,V(w),1)],8,de)]),_:2},1032,["index"]))),128))]),_:1}),l("div",re,[g(f,{onClick:t[0]||(t[0]=w=>e.doSave()),style:{width:"100px"},type:"primary",size:"large",disabled:e.hasChanged,"data-rerendered":e.ui.actionKey},{default:m(()=>[z(" Zapisz ")]),_:1},8,["disabled","data-rerendered"]),g(f,{onClick:t[1]||(t[1]=w=>e.doCancel()),style:{width:"100px"},type:"danger",size:"large",disabled:e.hasChanged,"data-rerendered":e.ui.actionKey},{default:m(()=>[z(" Anuluj ")]),_:1},8,["disabled","data-rerendered"])]),ue])]),l("section",pe,[l("div",ge,[(n(!0),d(b,null,v(e.structure.sections,(w,_)=>(n(),d("div",{id:_,class:"pt-4"},[l("div",_e,[l("h2",me,V(w),1),(n(!0),d(b,null,v(e.getOptions(_),s=>(n(),d("div",fe,[l("div",ye,[l("label",we,V(s.name),1),l("p",be,V(s.description),1)]),l("div",ve,[s.type==="toggle"?(n(),d("div",Se,[g(S,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i,size:"large"},null,8,["modelValue","onUpdate:modelValue"])])):s.type==="dropdownMultiselect"?(n(),d("div",Ve,[g(y,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i,size:"large",multiple:"","collapse-tags":"",placeholder:"Wybierz"},{default:m(()=>[(n(!0),d(b,null,v(s.options,(i,$)=>(n(),C(h,{key:$,label:i.currency,value:i.code},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):s.type==="dropdown"?(n(),d("div",$e,[g(y,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i,size:"large",placeholder:"Wybierz"},{default:m(()=>[(n(!0),d(b,null,v(s.options,(i,$)=>(n(),C(h,{key:$,label:i.currency,value:i.code},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):["textarea"].indexOf(s.type)>-1?(n(),d("div",ke,[g(x,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i,rows:5,size:"large",type:"textarea",placeholder:"Please input"},null,8,["modelValue","onUpdate:modelValue"])])):s.type==="color"?(n(),d("div",Ee,[g(A,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i},null,8,["modelValue","onUpdate:modelValue"])])):(n(),d("div",Ce,[g(x,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i,size:"large",placeholder:"Please input"},null,8,["modelValue","onUpdate:modelValue"])]))])]))),256))])],8,he))),256))])])])):D("",!0)}const j=L(oe,[["render",Oe],["__scopeId","data-v-dbb5159c"]]),xe=U({components:{Settings:j},mounted(){const e=Z("pluginConfig",{});se(e.prefix||"vue-app")}}),ze={class:"main-wrapper"};function Ue(e,t,a,o,c,r){const u=Q("Settings");return n(),d("div",ze,[g(u)])}const Le=L(xe,[["render",Ue]]),je=[{path:"/",component:j}],Ae=Y({history:ee(),routes:je});const O=X(Le);O.use(Ae);setTimeout(()=>{te(O,"vue_wp_plugin_config_admin"),O.mount("#vue-admin-app")},200);
